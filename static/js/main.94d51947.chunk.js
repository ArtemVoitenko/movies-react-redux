(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{41:function(e,t,a){e.exports=a(70)},46:function(e,t,a){},62:function(e,t,a){},63:function(e,t,a){},65:function(e,t,a){},66:function(e,t,a){},67:function(e,t,a){},68:function(e,t,a){},69:function(e,t,a){},70:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(21),i=a.n(o),c=a(13),s=a(7),l=a(8),m=a(10),u=a(9),v=a(11),f=a(18),p=(a(46),function(e){var t=e.id,a=e.title,n=e.onRemove;return r.a.createElement("div",{className:"col-6 col-md-4 col-lg-3"},r.a.createElement("div",{className:"movies-item  "},r.a.createElement("img",{src:"http://gravatar.com/avatar/".concat(t,"?s=300&d=identicon"),alt:"",className:"movies-item__img"}),r.a.createElement("p",{className:"movies-item__title"},a),r.a.createElement("div",{className:"btn-group"},r.a.createElement("button",{className:"movies-item__remove btn btn-danger",onClick:function(){n(t)}},"remove"),r.a.createElement(f.b,{className:"btn btn-info",to:"".concat(t)},"info"))))}),d=function(e){var t=e.movies,a=e.onRemove;return r.a.createElement("div",{className:"row"},t.map(function(e){return r.a.createElement(p,{key:e.id,id:e.id,title:e.Title,onRemove:function(e){a(e)}})}))},h=a(15),b=a(30),E=a.n(b);a(54),a(71),a(56);E.a.initializeApp({apiKey:"AIzaSyAaVShtXKH8jFPbKlsQsV__JCrONhLuJjU",authDomain:"movies-56bdf.firebaseapp.com",databaseURL:"https://movies-56bdf.firebaseio.com",projectId:"movies-56bdf",storageBucket:"",messagingSenderId:"870648658967",appId:"1:870648658967:web:39a0a0bbf70526d1"});var _=E.a,y=function(e){return{type:"ADD_MOVIE",payload:e}},N=a(40),S=a(20),g=a.n(S),O=function(e){return e.map(function(e){return function(e){var t={};return e.forEach(function(e){var a=Object(N.a)(e),n=a[0],r=a.slice(1);t[n]="".concat(r)}),t.id=g()(t.Title),t}(e.map(function(e){return e.split(": ")}))})},j=function(e){var t=function(e){for(var t=e.split(/\r?\n/),a=0,n=[],r=0;r<t.length;r++)if(""==t[r]&&a!==r){var o=t.slice(a,r);4===o.length&&n.push(o),a=r+1}return n}(e);return O(t)},w=(a(62),function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(m.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).handleFileRead=function(e){var t=e.result,n=j(t);a.setMoviesToDatabase(n)},a.handleFileChosen=function(e){var t=new FileReader;t.onloadend=function(){a.handleFileRead(t)},t.readAsText(e)},a.prepareDataForDb=function(e){var t={};return e.forEach(function(e){t[e.id]=e}),t},a.setMoviesToDatabase=function(e){var t=a.prepareDataForDb(e),n=a.props,r=n.addMoviesToStore,o=n.moviesInStore;_.database().ref("/movies").update(t).then(function(){r([].concat(Object(c.a)(o),Object(c.a)(e)))})},a}return Object(v.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("label",{className:"btn btn-success upload"},r.a.createElement("input",{type:"file",id:"file",className:"input-file",accept:".txt",onChange:function(t){return e.handleFileChosen(t.target.files[0])}}),"Upload")}}]),t}(n.Component)),C=Object(h.b)(function(e){return{moviesInStore:e.movies}},function(e){return{addMoviesToStore:function(t){e(y(t))}}})(w),F=(a(63),function(e){var t=e.onSearch;return r.a.createElement("input",{type:"text",placeholder:"Type movie title or actor's name to search",className:"search form-control",onChange:function(e){t(e.target.value)}})}),M=a(31),T=a.n(M),I=a(38),D=a(25),A=(a(65),function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(m.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={Title:"","Release Year":"",Format:"",Stars:"",id:"",validationError:""},a.typeMovieInput=function(e){a.setState(Object(D.a)({},e.target.name,e.target.value))},a.isMovieExists=function(e,t){return-1!=t.findIndex(function(t){return t.id===e})},a.validateMovieInputs=function(){var e=a.state,t=e.Title,n=e.Format,r=e.Stars,o=e.id,i=a.props.moviesInStore,c=a.state["Release Year"];t&&c&&n&&r?a.isMovieExists(o,i)&&a.setState({validationError:"Movie is already exists"}):a.setState({validationError:"Fill in all fields"})},a.setMovieToDb=function(){var e=a.props.moviesInStore;_.database().ref("/movies/".concat(g()(a.state.Title))).update(a.state).then(function(){a.props.addMoviesToStore([].concat(Object(c.a)(e),[a.state])),a.setState({Title:"","Release Year":"",Format:"",Stars:"",id:"",validationError:""})})},a.onCreateMovie=function(){var e=Object(I.a)(T.a.mark(function e(t){var n;return T.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,a.setState({id:g()(a.state.Title),validationError:""});case 3:a.validateMovieInputs(),(n=a.state.validationError)?alert(n):(a.setMovieToDb(),a.props.hideCreateForm());case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a}return Object(v.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.state,t=e.Title,a=e.Format,o=e.Stars,i=(e.id,this.state["Release Year"]),c=this.props,s=c.formVisibility,l=c.showCreateForm,m=c.hideCreateForm;return r.a.createElement(n.Fragment,null,r.a.createElement("button",{className:"btn btn-warning",onClick:l},"Add movie"),r.a.createElement("div",{className:"movie-form__wrapper ".concat(s?"active":null)},r.a.createElement("form",{className:"movie-form",onSubmit:this.onCreateMovie},r.a.createElement("button",{type:"button",className:"btn btn-danger movie-form__close",onClick:m},"X"),r.a.createElement("p",{className:"movie-form__title"},"Add new movie"),r.a.createElement("label",{htmlFor:"",className:"movie-form__label"},r.a.createElement("span",{className:"movie-form__tip"},"Title"),r.a.createElement("input",{onChange:this.typeMovieInput,type:"text",name:"Title",value:t,className:"movie-form__input form-control"})),r.a.createElement("label",{htmlFor:"",className:"movie-form__label"},r.a.createElement("span",{className:"movie-form__tip"},"Release year"),r.a.createElement("input",{onChange:this.typeMovieInput,type:"text",name:"Release Year",value:i,className:"movie-form__input form-control"})),r.a.createElement("label",{htmlFor:"",className:"movie-form__label"},r.a.createElement("span",{className:"movie-form__tip"},"Format"),r.a.createElement("input",{onChange:this.typeMovieInput,type:"text",name:"Format",className:"movie-form__input form-control",value:a})),r.a.createElement("label",{htmlFor:"",className:"movie-form__label"},r.a.createElement("span",{className:"movie-form__tip"},"Stars"),r.a.createElement("input",{onChange:this.typeMovieInput,type:"text",name:"Stars",className:"movie-form__input form-control",value:o})),r.a.createElement("button",{className:"movie-form__submit btn btn-success",type:"submit"},"Add movie"))))}}]),t}(n.Component)),k=(a(66),function(e){var t=e.onSortChanged;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"sort"},r.a.createElement("div",{className:"sort__label"}," Alphabet sort:"),r.a.createElement("input",{className:"switch__input",type:"checkbox",id:"switch",onChange:function(e){t(e.target.checked)}}),r.a.createElement("label",{className:"switch sort__switch",htmlFor:"switch"})))}),R=(a(67),function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(m.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={searchQuery:"",sort:!1,formVisibility:!1},a.removeItemFromStore=function(e){var t=a.props.movies,n=t.findIndex(function(t){return t.id===e}),r=[].concat(Object(c.a)(t.slice(0,n)),Object(c.a)(t.slice(n+1)));a.props.addMoviesToStore(r)},a.removeItemFromDb=function(e){_.database().ref("/movies/".concat(e)).remove().then(function(){a.removeItemFromStore(e)})},a.showCreateForm=function(){a.setState({formVisibility:!0})},a.hideCreateForm=function(){a.setState({formVisibility:!1})},a.onSearch=function(e){a.setState({searchQuery:e})},a.onSortChanged=function(e){a.setState({sort:e})},a.filterMovies=function(e,t){return t.filter(function(t){return t.Title.toLowerCase().includes(e.toLowerCase())||t.Stars.toLowerCase().includes(e.toLowerCase())})},a.sortByAlphabet=function(e){return Object(c.a)(e).sort(function(e,t){return e.Title.toLowerCase()>t.Title.toLowerCase()?1:-1})},a}return Object(v.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;_.database().ref("/movies/").once("value").then(function(t){if(t.val())return e.props.addMoviesToStore(Object.values(t.val()))})}},{key:"render",value:function(){var e=this.props,t=e.movies,a=e.addMoviesToStore,n=this.state,o=n.searchQuery,i=n.sort,c=n.formVisibility,s=i?this.sortByAlphabet(t):t,l=this.filterMovies(o,s),m=t.length?r.a.createElement(d,{onRemove:this.removeItemFromDb,movies:l}):null;return r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"header jumbotron"},r.a.createElement(F,{onSearch:this.onSearch}),r.a.createElement(C,null),r.a.createElement(A,{moviesInStore:this.props.movies,addMoviesToStore:a,showCreateForm:this.showCreateForm,formVisibility:c,hideCreateForm:this.hideCreateForm}),r.a.createElement(k,{onSortChanged:this.onSortChanged})),m)}}]),t}(n.Component)),x=Object(h.b)(function(e){return{movies:e.movies}},function(e){return{addMoviesToStore:function(t){e(y(t))}}})(R),V=(a(68),function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return(a=Object(m.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).state={movie:{}},a.getMovieFromDb=function(e){_.database().ref("/movies/".concat(e)).once("value").then(function(e){a.setState({movie:e.val()})})},a.renderActors=function(e){var t=e.split(", ");return r.a.createElement("div",{className:"movie-info__actors"},t.map(function(e){return r.a.createElement("div",{className:"movie-info__actor"},r.a.createElement("img",{src:"https://robohash.org/".concat(e),alt:"",className:"movie-info__avatar"}),r.a.createElement("p",{className:"movie-info__name"},e))}))},a}return Object(v.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){console.log(this.props.itemId),this.getMovieFromDb(this.props.movieId)}},{key:"render",value:function(){var e=this.state.movie,t=e.Title,a=e.Stars,n=e.id,o=e.Format,i=this.state.movie["Release Year"],c=a?this.renderActors(a):null;return r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-12 col-md-5 jumbotron"},r.a.createElement("img",{src:"http://gravatar.com/avatar/".concat(n,"?s=500&d=identicon"),alt:"",className:"img-responsive"})),r.a.createElement("div",{className:"col-12 col-md-7"},r.a.createElement("div",{className:"movie-info"},r.a.createElement("p",{className:"movie-info__title"},t),r.a.createElement("p",{className:"movie-info__item"},"Release Year: ",i),r.a.createElement("p",{className:"movie-info__item"},"Format: ",o),r.a.createElement("p",{className:"movie-info__item"},"Stars: ",c)))))}}]),t}(n.Component)),L=a(14),Y=(a(69),function(){return r.a.createElement(n.Fragment,null,r.a.createElement(L.a,{path:"/",exact:!0,component:x}),r.a.createElement(L.a,{path:"/:id",render:function(e){var t=e.match;return r.a.createElement(V,{movieId:t.params.id})}}))}),X=function(){return r.a.createElement("div",{className:"error-indicator"},"Error!!!!!")},U=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(m.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={hasError:!1},a}return Object(v.a)(t,e),Object(l.a)(t,[{key:"componentDidCatch",value:function(){this.setState({hasError:!0})}},{key:"render",value:function(){return this.state.hasError?r.a.createElement(X,null):this.props.children}}]),t}(n.Component),B=a(24),J=a(39),Q={movies:[]},K=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Q,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_MOVIE":return Object(J.a)({},e,{movies:t.payload});default:return e}},z=Object(B.b)(K,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());i.a.render(r.a.createElement(h.a,{store:z},r.a.createElement(U,null,r.a.createElement(f.a,null,r.a.createElement(Y,null)))),document.getElementById("root"))}},[[41,1,2]]]);
//# sourceMappingURL=main.94d51947.chunk.js.map